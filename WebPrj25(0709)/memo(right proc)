  --오른쪽 공통코드 관리 
  PROCEDURE PROC_SEL_COM(
    IN_GRP_ID IN VARCHAR2,
    O_CUR OUT SYS_REFCURSOR
  );
  --DELETE
  PROCEDURE PROC_DEL_COM(
  IN_GRP_ID IN VARCHAR2,
  IN_COM_ID IN VARCHAR2
  );
  
  --UPDATE
  PROCEDURE PROC_UP_COM(
  IN_GRP_ID IN VARCHAR2,
  IN_COM_ID IN VARCHAR2,
  IN_COM_VAL IN VARCHAR2,
  IN_COM_LVL IN VARCHAR
  )
  ;
  
  --INSERT
  PROCEDURE PROC_INS_COM(
  IN_GRP_ID IN VARCHAR2,
  IN_COM_VAL IN VARCHAR2,
  IN_COM_LVL IN VARCHAR2,
  IN_PARENT_ID IN VARCHAR2
  )
  ; 
  
  
  
  
  ======================
  
  
   --공통코드 관리 
    PROCEDURE PROC_SEL_COM(
    IN_GRP_ID IN VARCHAR2,
    O_CUR OUT SYS_REFCURSOR
  )
  AS
  
  BEGIN
  
    OPEN O_CUR FOR
    --이렇게 해도 됌
--    SELECT GRP_ID, COM_ID, COM_VAL, COM_LVL
--    FROM COMMONS_TBL
--    WHERE GRP_ID = IN_GRP_ID
--    ;



    ---===============계층형 쿼리  START WITH --계층형 쿼리의 제일 꼭대기 지점 ROOT 를 말하는거지
--    SELECT LPAD(' ' ,2*(LEVEL-1)) || COM_VAL, COM_ID
--    FROM COMMONS_TBL 
--    WHERE GRP_ID = 'GRP001'
--    START WITH PARENT_ID = 'ROOT' AND GRP_ID = 'GRP001'
--    CONNECT BY PRIOR COM_ID = PARENT_ID AND GRP_ID = 'GRP001'
    
    SELECT LPAD(' ' ,2*(LEVEL-1)) || COM_VAL AS COM_VAL
    ,COM_ID , GRP_ID, COM_LVL
    FROM COMMONS_TBL 
    WHERE GRP_ID = IN_GRP_ID
    START WITH PARENT_ID = 'ROOT' AND GRP_ID = IN_GRP_ID
    CONNECT BY PRIOR COM_ID = PARENT_ID AND GRP_ID = IN_GRP_ID
    ;
    
  END
  PROC_SEL_COM
  ;
  --DELETE
  PROCEDURE PROC_DEL_COM(
  IN_GRP_ID IN VARCHAR2,
  IN_COM_ID IN VARCHAR2
  )
  
  AS
  
  BEGIN
    DELETE FROM COMMONS_TBL 
    WHERE GRP_ID = IN_GRP_ID
    AND COM_ID = IN_COM_ID
    ;
  END
  PROC_DEL_COM
  ;
  
  --UPDATE
  PROCEDURE PROC_UP_COM(
  IN_GRP_ID IN VARCHAR2,
  IN_COM_ID IN VARCHAR2,
  IN_COM_VAL IN VARCHAR2,
  IN_COM_LVL IN VARCHAR
  )
  AS
  
  BEGIN
    UPDATE COMMONS_TBL
    SET COM_VAL = IN_COM_VAL, COM_LVL = IN_COM_LVL
    WHERE GRP_ID = IN_GRP_ID
    AND COM_ID = IN_COM_ID
    ;
    
  END
  PROC_UP_COM
  ;
 
  --INSERT 
    PROCEDURE PROC_INS_COM(
  IN_GRP_ID IN VARCHAR2,
  IN_COM_VAL IN VARCHAR2,
  IN_COM_LVL IN VARCHAR2,
  IN_PARENT_ID IN VARCHAR2
  )
  AS
    V_COM_ID VARCHAR2(10);
  BEGIN
    
    SELECT 'COM' || TRIM(TO_CHAR(TO_NUMBER(SUBSTR(NVL(MAX(COM_ID),'COM0000'),4,4))+1,'0000'))
    INTO V_COM_ID
    FROM COMMONS_TBL
    WHERE GRP_ID = IN_GRP_ID
    ;
    
    INSERT INTO COMMONS_TBL
    (COM_ID,GRP_ID,COM_VAL,COM_LVL,PARENT_ID)
    VALUES
    (V_COM_ID, IN_GRP_ID, IN_COM_VAL, IN_COM_LVL, IN_PARENT_ID )
    ;
    
  END
  PROC_INS_COM
  ;
  